---
import Layout from "~/layouts/Layout.astro";
import Company from "~/components/company.astro";
import IAESTE from "~/assets/companies/IAESTE.webp";
import iGem from "~/assets/companies/iGem Lund.webp";
import Infrasight from "~/assets/companies/Infrasight Labs.webp";
import Iternio from "~/assets/companies/Iternio-Rivian.webp";
import LFS from "~/assets/companies/Lund formula student.webp";
import MCA from "~/assets/companies/MCA.webp";
import Molnlycke from "~/assets/companies/Molnlycke Health Care.webp";
import Neo4j from "~/assets/companies/Neo4j.webp";
import Netcompany from "~/assets/companies/Netcompany.webp";
import Sectra from "~/assets/companies/Sectra.webp";
import Tactel from "~/assets/companies/Tactel.webp";
import Verisure from "~/assets/companies/Verisure.webp";
import Visma from "~/assets/companies/Visma.webp";
import Voyado from "~/assets/companies/Voyado.webp";
import Acconeer from "~/assets/companies/Acconeer.webp";
import ASSA from "~/assets/companies/ASSA ABLOY.webp";
import Axis from "~/assets/companies/Axis Communications.webp";
import Bosch from "~/assets/companies/Bosch.webp";
import Capgemini from "~/assets/companies/Capgemini.webp";
import Combitech from "~/assets/companies/Combitech.webp";
import Cygni from "~/assets/companies/Cygni.webp";
import Ericsson from "~/assets/companies/Ericsson.webp";
import Gigstep from "~/assets/companies/Gigstep.webp";
import Grade from "~/assets/companies/Grade.webp";
import Hello from "~/assets/companies/Hello World!.webp";
import Edda from "~/assets/companies/Edda Knowledge.webp";

const companies: { name: string; description: string; image: ImageMetadata }[] =
  [];
---

<Layout>
  {
    companies.length > 0 ? (
      <div
        class="mx-auto grid max-w-prose grid-cols-2 gap-4 p-8 sm:grid-cols-3 md:grid-cols-4"
        id="company-container"
      >
        {companies
          .sort((c1, c2) => {
            if (c1.name < c2.name) return -1;
            if (c1.name > c2.name) return 1;
            return 0;
          })
          .map((company) => (
            <div
              id={company.name}
              data-description={company.description}
              class="contents"
            >
              <Company {...company} />
            </div>
          ))}
      </div>
    ) : (
      <div class="text-4xl text-center font-bold pt-24">Coming soon!</div>
    )
  }
</Layout>

<div
  class="relative z-10 hidden"
  aria-labelledby="modal-title"
  role="dialog"
  aria-modal="true"
  id="modal"
>
  <!--Background backdrop, show/hide based on modal state. -->
  <div
    id="modal-backdrop"
    class="fixed inset-0 bg-gray-500 bg-opacity-75 transition-opacity"
  >
  </div>

  <div class="fixed inset-0 top-20 z-10 w-screen">
    <div
      class="flex min-h-full items-end justify-center p-4 text-center sm:items-center sm:p-0"
    >
      <!-- Modal panel, show/hide based on modal state. -->
      <div
        class="relative transform overflow-hidden rounded-lg text-left shadow-xl transition-all sm:my-8 sm:w-full sm:max-w-lg"
      >
        <div
          class="max-h-96 overflow-y-auto bg-default px-4 pb-4 pt-5 sm:p-6 sm:pb-4 short:max-h-80"
        >
          <div class="sm:flex sm:items-start">
            <div class="mt-3 text-center sm:ml-4 sm:mt-0 sm:text-left">
              <h3
                class="font-semibold leading-6 text-default text-base"
                id="modal-title"
              >
              </h3>
              <div class="mt-2">
                <p
                  class="break-words text-offset text-sm"
                  id="modal-description"
                >
                </p>
              </div>
            </div>
          </div>
        </div>
        <div class="bg-default px-4 py-3 sm:flex sm:flex-row-reverse sm:px-6">
          <button
            id="modal-close"
            type="button"
            class="mt-3 inline-flex w-full justify-center rounded-md bg-default px-3 py-2 font-semibold text-default text-sm sm:mt-0 sm:w-auto"
          >
            Close
          </button>
        </div>
      </div>
    </div>
  </div>
</div>

<script>
  function setupModal() {
    const companies = document.querySelectorAll("#company-container > div");
    companies.forEach((company) => {
      company.addEventListener("click", () => {
        const name = company.id;
        const description = company.getAttribute("data-description");
        document.querySelector("#modal-title")!.textContent = name;
        document.querySelector("#modal-description")!.textContent = description;
        document.querySelector("#modal")?.classList.toggle("hidden");
      });
    });

    document.querySelector("#modal-close")?.addEventListener("click", () => {
      document.querySelector("#modal")?.classList.toggle("hidden");
    });
  }
  setupModal();
  document.addEventListener("astro:after-swap", setupModal);
</script>
